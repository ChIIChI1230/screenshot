# 截图工具使用说明

## 功能概述

这是一个分布式截图工具，包含客户端和服务端两个部分：

- **客户端**: 定时截取屏幕并上传到服务器
- **服务端**: 接收并保存客户端上传的截图

## 文件结构

```
screenshot/
├── client_gui.py          # 客户端GUI界面
├── server_gui.py          # 服务端GUI界面
├── client.py              # 客户端核心逻辑
├── server.py              # 服务端核心逻辑
├── config.json            # 配置文件
├── build.py               # 打包脚本
├── build.bat              # Windows打包批处理
├── requirements.txt       # Python依赖
└── 使用说明.md           # 本文件
```

## 安装依赖

```bash
pip install -r requirements.txt
```

## 运行方式

### 方式1: 直接运行Python脚本

**启动服务端:**
```bash
python server_gui.py
```

**启动客户端:**
```bash
python client_gui.py
```

### 方式2: 打包成exe文件

**自动打包:**
```bash
# Windows
build.bat

# 或手动执行
python build.py
```

**运行打包后的程序:**
1. 进入 `release/` 目录
2. 双击 `启动服务端.bat` 启动服务端
3. 双击 `启动客户端.bat` 启动客户端

## 配置说明

### 服务端配置

在服务端GUI界面中配置：

- **主机地址**: 服务端监听地址 (默认: 0.0.0.0)
- **端口号**: 服务端端口 (默认: 8000)
- **存储目录**: 截图保存目录

### 客户端配置

在客户端GUI界面中配置：

- **服务器地址**: 服务端地址 (如: http://192.168.1.100:8000/upload)
- **截图间隔**: 截图间隔秒数 (默认: 10秒)
- **图片质量**: JPEG质量 1-100 (默认: 80)
- **保存本地副本**: 是否在本地保存截图副本
- **本地输出目录**: 本地副本保存目录
- **本地存储目录**: 服务器不可用时的临时存储目录
- **最大本地文件数**: 本地存储的最大文件数
- **文件保留时间**: 本地文件保留时间(小时)

## 工作流程

1. **正常情况**: 客户端定时截图 → 直接上传到服务器 → 服务器保存截图
2. **服务器离线**: 客户端截图 → 保存到本地存储 → 等待服务器恢复
3. **服务器恢复**: 自动上传本地存储的图片 → 删除本地文件

## 日志文件

- **客户端日志**: `client.log`
- **服务端日志**: `server.log`

## 故障排除

### 常见问题

1. **客户端无法连接服务器**
   - 检查服务器地址和端口是否正确
   - 确认服务端是否正在运行
   - 检查防火墙设置

2. **截图上传失败**
   - 检查网络连接
   - 查看客户端日志文件
   - 确认服务器存储目录权限

3. **GUI界面无法启动**
   - 确认已安装所有依赖
   - 检查Python版本 (需要3.8+)
   - 查看错误日志

### 日志查看

查看日志文件了解详细错误信息：

```bash
# 客户端日志
tail -f client.log

# 服务端日志  
tail -f server.log
```

## 技术特性

- **智能存储**: 服务器不可用时自动保存到本地
- **自动重传**: 服务器恢复后自动上传本地图片
- **中文界面**: 完全中文化的用户界面
- **日志记录**: 详细的中文日志记录
- **配置管理**: 图形化配置界面
- **一键打包**: 支持打包成exe文件

## 开发说明

### 核心模块

- `client.py`: 客户端核心逻辑，包含截图、上传、本地存储等功能
- `server.py`: 服务端核心逻辑，Flask服务器，接收上传的截图

### GUI模块

- `client_gui.py`: 客户端图形界面
- `server_gui.py`: 服务端图形界面

### 打包

使用PyInstaller打包成exe文件：

```bash
# 安装打包依赖
pip install pyinstaller

# 自动打包
python build.py

# 或使用批处理
build.bat
```

## 许可证

本项目采用MIT许可证。
